# WGCNA Analysis Report: Gene Co-expression in Brachypodium

## 1. Methodology: How the Analysis was Performed
To construct the gene co-expression network, we employed the **WGCNA** package in R. The process involved:
* **Data Preprocessing:** Cleaning the `TPM_counts_Drought_W_dataset.csv` and transposing it for compatibility.
* **Network Construction:** Calculating a weighted adjacency matrix using a soft-thresholding power.
* **Module Identification:** Identifying clusters of highly correlated isoforms using the Dynamic Tree Cut algorithm based on Topological Overlap (TOM).
* **Trait Correlation:** Calculating Pearson correlations between module eigengenes and phenotypic traits.



---

## 2. Main Specific Inputs and Outputs
| Analysis Step | Main Input File | Main Output / Result |
| :--- | :--- | :--- |
| **Expression Input** | `TPM_counts_Drought_W_dataset.csv` | Cleaned expression matrix |
| **QC & Outliers** | Transposed Matrix | `sampleClustering.pdf` |
| **Network Scaling** | Expression Data | Scale-free Topology Fit Plots |
| **Module Definition** | TOM Matrix | `net_W.RData` and Cluster Dendrogram |
| **Trait Association** | `Traits_Drought_W_dataset.csv` | `heatmap_traits_modules_W.pdf` |

---

## 3. Results (Exercise Solutions)
* **3.1 Samples & Isoforms:** 18 samples and 34,492 isoforms were processed.
* **3.2 Outliers:** **1 sample** (`Adi10_W_02`) was discarded after outlier analysis.
* **3.3 Power Value:** A soft-thresholding power of **6** was chosen for adjacency calculation.
* **3.4 Module Merging:** **40 modules** were found initially; **36 modules** remained after merging (cut height 0.25).
* **3.5 Cyan Module Hub:** The hub isoform for the Cyan module is **Bradi5g01000.1**.
* **3.6 Trait Correlation:** The **Violet module** shows the highest positive correlation (**0.66**, p=3e-04) with the **"blwgrd"** (below ground biomass) trait.



---

## 4. Problems Encountered
The analysis faced significant technical challenges regarding the R environment:
* **Dependency Issues:** The required `GO.db` package failed to install from source due to local configuration limits. This was bypassed by installing the **binary version** through BiocManager.
* **Path Length & Encoding:** Windows file path limitations and localized characters in the user path caused directory access errors. Moving the project to a root directory (`D:/Proje`) and setting the path manually solved these issues.

---

## 5. Proposed Experiment
**Title:** Transcriptomic Response to Salt Stress in Wheat Varieties.
**Proposed Setup:** Using this WGCNA pipeline, we could analyze wheat exposed to saline vs. non-saline conditions. Identifying modules correlated with "Na+ exclusion" or "yield stability" would reveal hub genes that could be targeted via CRISPR-Cas9 to develop salt-tolerant crops.
